<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A wrapper class based on a predictor object for examining the
predictions of the model with respect to one or two features.
The two methods for interpreting a model based on one or two features are partial
dependence plots (PDP), which averages over the marginal distribution
of the predictions of the model, and accumulated local effects (ALE) functions
which averages over the conditional distribution of the predictions of the model.
The only necessary argument is the Predictor object. The other arguments are
optional, but it may be useful to specify the number of samples or the specific
data points (data.points) if the training data is very large.
This can greatly reduce the time for computation.
For the output, the model returns an interpreter object with two lists of
functions: one for interpreting a single feature's role in the black-box
model, and the other for intepreting a pair of features' role in the
black-box model. These interpretability functions are built for each
possible feature (or pair of features). Each of these functions return
a vector of averaged predictions equal in length to the number of
values (or number of rows) input into the function."><title>Interpreter class description — Interpreter • distillML</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpreter class description — Interpreter"><meta property="og:description" content="A wrapper class based on a predictor object for examining the
predictions of the model with respect to one or two features.
The two methods for interpreting a model based on one or two features are partial
dependence plots (PDP), which averages over the marginal distribution
of the predictions of the model, and accumulated local effects (ALE) functions
which averages over the conditional distribution of the predictions of the model.
The only necessary argument is the Predictor object. The other arguments are
optional, but it may be useful to specify the number of samples or the specific
data points (data.points) if the training data is very large.
This can greatly reduce the time for computation.
For the output, the model returns an interpreter object with two lists of
functions: one for interpreting a single feature's role in the black-box
model, and the other for intepreting a pair of features' role in the
black-box model. These interpretability functions are built for each
possible feature (or pair of features). Each of these functions return
a vector of averaged predictions equal in length to the number of
values (or number of rows) input into the function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">distillML</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/advanced_plotting.html">Plotting Methods</a>
    <a class="dropdown-item" href="../articles/local_surrogates.html">Local Surrogate</a>
    <a class="dropdown-item" href="../articles/model_distillation.html">Distillation Methods</a>
    <a class="dropdown-item" href="../articles/smoothing.html">Smoothing PDP + ALE Curves</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/forestry-labs/distillML/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Interpreter class description</h1>
      <small class="dont-index">Source: <a href="https://github.com/forestry-labs/distillML/blob/HEAD/R/interpret.R" class="external-link"><code>R/interpret.R</code></a></small>
      <div class="d-none name"><code>Interpreter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A wrapper class based on a predictor object for examining the
predictions of the model with respect to one or two features.
The two methods for interpreting a model based on one or two features are partial
dependence plots (PDP), which averages over the marginal distribution
of the predictions of the model, and accumulated local effects (ALE) functions
which averages over the conditional distribution of the predictions of the model.</p>
<p>The only necessary argument is the Predictor object. The other arguments are
optional, but it may be useful to specify the number of samples or the specific
data points (data.points) if the training data is very large.
This can greatly reduce the time for computation.</p>
<p>For the output, the model returns an interpreter object with two lists of
functions: one for interpreting a single feature's role in the black-box
model, and the other for intepreting a pair of features' role in the
black-box model. These interpretability functions are built for each
possible feature (or pair of features). Each of these functions return
a vector of averaged predictions equal in length to the number of
values (or number of rows) input into the function.</p>
    </div>


    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The class that wraps a Predictor object for application of different
interpretability methods. For usage examples, please refer to the README
document.</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>predictor</code></dt>
<dd><p>The Predictor object that contains the model that the user wants
to query. This is the only parameter that is required to initialize an
Interpreter object. All entries in the vector must
match column names from the `data` parameter of the Predictor object.</p></dd>


<dt><code>features</code></dt>
<dd><p>An optional list of single features that we want to create PDP functions for.</p></dd>


<dt><code>features.2d</code></dt>
<dd><p>A two column data frame that contains pairs of names that we
want to create 2D PDP functions for. All entries in the data frame must
match column names from the `data` parameter of the Predictor object.</p></dd>


<dt><code>data.points</code></dt>
<dd><p>A vector of indices of data points in the training
data frame to be used as the observations for creating the PDP/ICE/ALE plots.
When the training data is large, it can greatly reduce the required computation
to pass only a downsampled subset of the training data to the pdp
function construction. Alternatively, if one is only interested understanding
the model predictions for a specific subgroup, the indices of the observations
in the given subgroup can be passed here.</p></dd>


<dt><code>pdp.1d</code></dt>
<dd><p>A List of functions giving single feature PDP interpretations of the model.</p></dd>


<dt><code>pdp.2d</code></dt>
<dd><p>A List of functions giving two-feature PDP interpretations of the model</p></dd>


<dt><code>feat.class</code></dt>
<dd><p>A vector that contains the class for each feature (categorical or continuous)</p></dd>


<dt><code>center.at</code></dt>
<dd><p>The value(s) to center the feature plots at. A list of equal length
to the length of the features.</p></dd>


<dt><code>grid.points</code></dt>
<dd><p>A list of vectors containing the grid points to use for
the predictions for PDP and ICE plots. For ALE plots, we
use quantile-based methods that depend on the distribution of
the training data.</p></dd>


<dt><code>grid.size</code></dt>
<dd><p>The number of grid points to plot for a continuous feature. This
parameter sets the number of grid points for PDP, ICE, and ALE plots.</p></dd>


<dt><code>saved</code></dt>
<dd><p>A list that caches the previous calculations for the 1-D ICE plots,
1-D PDP plots, 2-D PDP plots, and grid points for building the distilled model.
This saves the uncentered calculations.</p></dd>


<dt><code>ale.grid</code></dt>
<dd><p>A list that caches the saved predictions for the ALE plots</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-new"><code>Interpreter$new()</code></a></p></li>
<li><p><a href="#method-clone"><code>Interpreter$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>

<div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va"><a href="../reference/Interpreter.html">Interpreter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  predictor <span class="op">=</span> <span class="cn">NULL</span>,
  samples <span class="op">=</span> <span class="fl">1000</span>,
  data.points <span class="op">=</span> <span class="cn">NULL</span>,
  grid.size <span class="op">=</span> <span class="fl">50</span>
<span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>predictor</code></dt>
<dd><p>The Predictor object that contains the model that the user wants
to query. This is the only parameter that is required to initialize an
Interpreter object. All entries in the vector must
match column names from the `data` parameter of the Predictor object.</p></dd>


<dt><code>samples</code></dt>
<dd><p>The number of observations used for the interpretability
method. If no number is given, the default set is the
minimum between 1000 and the number of rows in the
training data set. Rows with missing values are excluded from
being sampled.</p></dd>


<dt><code>data.points</code></dt>
<dd><p>The indices of the data points used for the PDP/ALE. This
overwrites the "samples" parameter above.</p></dd>


<dt><code>grid.size</code></dt>
<dd><p>The number of grid points used to create for the PDP, ICE, and ALE
plots for each feature.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>An `Interpreter` object.</p>
</div>

</div><p></p><hr><a id="method-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va">Interpreter</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/forestry-labs/distillML" class="external-link">distillML</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/forestry-labs/Rforestry" class="external-link">Rforestry</a></span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘Rforestry’ was built under R version 4.1.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ## </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##  Rforestry (Version 0.9.0.95, Build Date: R 4.1.2; x86_64-apple-darwin17.0; 2022-03-10 13:19:39 UTC; unix)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##  See https://github.com/forestry-labs for additional documentation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##  Please cite software as:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##    Soren R. Kunzel, Theo F. Saarinen, Edward W. Liu, Jasjeet S. Sekhon. 2019.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##    ''Linear Aggregation in Tree-based Estimators.'' arXiv preprint </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##    arXiv:1906.06463. https://arxiv.org/abs/1906.06463 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">491</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/crabs.html" class="external-link">crabs</a></span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Male <span class="op">=</span> <span class="st">"M"</span>, Female <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Orange <span class="op">=</span> <span class="st">"O"</span>, Blue <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"Sex"</span>,<span class="st">"Index"</span>,<span class="st">"Frontal Lobe"</span>,</span>
<span class="r-in"><span class="st">"Rear Width"</span>, <span class="st">"Carapace Length"</span>,<span class="st">"Carapace Width"</span>,<span class="st">"Body Depth"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">test_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">train_reg</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">test_ind</span>,<span class="op">]</span></span>
<span class="r-in"><span class="va">test_reg</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">test_ind</span>,<span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rforestry/man/forestry.html" class="external-link">forestry</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">train_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">train_reg</span><span class="op">)</span><span class="op">==</span><span class="st">"Carapace Width"</span><span class="op">)</span><span class="op">]</span>,</span>
<span class="r-in">y<span class="op">=</span><span class="va">train_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">train_reg</span><span class="op">)</span><span class="op">==</span><span class="st">"Carapace Width"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">forest_predictor</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>model <span class="op">=</span> <span class="va">forest</span>, data<span class="op">=</span><span class="va">train_reg</span>,</span>
<span class="r-in">y<span class="op">=</span><span class="st">"Carapace Width"</span>, task <span class="op">=</span> <span class="st">"regression"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">forest_interpret</span> <span class="op">&lt;-</span> <span class="va">Interpreter</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>predictor <span class="op">=</span> <span class="va">forest_predictor</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Cho, Theo Saarinen, Simon Walter, Jasjeet Sekhon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

